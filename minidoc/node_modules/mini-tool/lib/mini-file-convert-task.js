
var util          = require('util'); 
var EventEmitter  = require('events').EventEmitter; 

function MiniFileConvertTask(miniHttp,client){
	EventEmitter.call(this); 
	var docNodeName  = miniHttp.appConfig.name; 
	var hKey         = docNodeName+"_convertList"; 
	var downloadUrl  = miniHttp.queryParam("download_url","");
	var callbackUrl  = miniHttp.queryParam("callback_url","");
	var signature    = miniHttp.queryParam("signature","");
	var mimeType     = miniHttp.queryParam("mime_type","");
	if(downloadUrl!=""){
		var task = {
			"downloadUrl":downloadUrl,
			"callbackUrl":callbackUrl,
			"signature":signature,
			"mimeType":mimeType
		}; 
	    client.lpush(hKey, JSON.stringify(task));
	}   
	//发送任务接受成功请求
	var data = {
			"status":1
	}; 
	var responseData = {
			code:200,
			data:data
	};				
	miniHttp.response(responseData);
} 
exports.MiniFileConvertTask = MiniFileConvertTask;
util.inherits(MiniFileConvertTask, EventEmitter);
